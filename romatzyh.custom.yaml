# Rime schema
# encoding: utf-8

patch:
 # switches:
  switches:
    - name: ascii_mode
      reset: 0
      states: [ 中文, 西文 ]
    - name: full_shape
      states: [ 半角, 全角 ]
    - name: simplification
      states: [ 傳統, 簡化 ]
    # - name: ascii_punct
      # states: [ ，。, ，． ]
    - name: extended_charset
      states: [ 通用, 增廣 ]
 
 # engine:
  "engine/processors":
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor  # 普通输入
    # - fluency_editor  # 语句流输入
 
 # speller:
  # "speller/alphabet": 'zyxwvutsrqponmlkjihgfedcba'
  # "speller/initials": 'zywutsrqponmlkjihgfedcba'
  # "speller/finals": 'v'
  "speller/delimiter": " ;'"
  # "speller/use_space": true
  "speller/algebra":  # 拼寫處理器把5改为v
    - erase/^xx$/
    - xform/\<r5/el/
    - xform/\<([jqx])u/$1v/
    - xform/([zcsrh])i([1-4])\>/$1Y$2/
    - xform/\<er/el/
    - xform/\<zh/j/
    - xform/\<z([aeiouyY])/tz$1/
    - xform/\<c([aeiouyY])/ts$1/
    - xform/\<q/ch/
    - xform/\<x/sh/
    - xform/iu([1-5])\>/iou$1/
    - xform/ui([1-5])\>/uei$1/
    - xform/ao([1-5])\>/au$1/
    - xform/un([1-5])\>/uen$1/
    - xform/v/iu/
    - xform/\<wu([1-5])\>/u$1/
    - xlit/yw/iu/
    - xform/ii/i/
    - xform/\<([lnmr]\w+)2\>/$1/
    - xform/\<([lmnr])(\w+1)\>/$1h$2/
    - xform/1\>//
    - xform/i(\w+)2\>/y$1/ 
    - xform/u(\w+)2\>/w$1/    
    - xform/(a|e|o)(i|u)2\>/$1$2r/
    - xform/(a|e|o)(|l|n|ng)2\>/$1r$2/
    - xform/i2\>/yi/
    - xform/u2\>/wu/
    - xform/\<ie3\>/yee/
    - xform/\<uo3\>/woo/
    - xform/\<i(\w*3)\>/yi$1/
    - xform/\<u(\w*3)\>/wu$1/
    - xform/i([aou]\w*)3\>/e$1/
    - xform/u([ae]\w*)3\>/o$1/
    - xform/i(n|ng)3\>/ii$1/
    - xform/ie3\>/iee/
    - xform/uo3\>/uoo/
    - xform/ai3\>/ae/
    - xform/au3\>/ao/
    - xform/(a|e|o)(|i|l|u|n|ng)3\>/$1$1$2/
    - xform/i3\>/ii/
    - xform/u3\>/uu/
    - xform/\<i4\>/yih/
    - xform/\<iu4\>/yuh/
    - xform/\<u4\>/wuh/
    - xform/\<in4\>/yinn/ 
    - xform/\<ing4\>/yinq/
    - xform/\<i(\w+4)\>/y$1/
    - xform/\<u(\w+4)\>/w$1/
    - xform/(a|e|o)4\>/$1h/
    - xform/(a|o)u4\>/$1w/
    - xform/(e|a)i4\>/$1y/
    - xform/u4\>/uh/
    - xform/i4\>/ih/
    - xform/n4\>/nn/
    - xform/l4\>/ll/
    - xform/ng4\>/nq/
    - xform/Y\>/y/
    - xform/Y2\>/yr/
    - xform/Y3\>/yy/
    - xform/Y4\>/yh/
    - xform/5\>/v/
    - abbrev/^([a-z]+)$/$1/
    - abbrev/^(ts|tz|sh|ch)\w+$/$1/
    
    - abbrev/ch/q/
    - abbrev/sh/x/
    - abbrev/tz/z/
    - abbrev/ts/c/
    - abbrev/ng/v/
    - abbrev/nq/q/
    - abbrev/iann/ien/
    - abbrev/iuann/von/
    - abbrev/iuan/ion/
    - abbrev/yuan/yon/
    - abbrev/euan/eon/
    - abbrev/iueh/veh/
    - abbrev/uann/uon/
    - abbrev/iunn/vun/
    - abbrev/uei/ui/
    - abbrev/wei/wi/
    - abbrev/oei/oi/
    - abbrev/uey/uy/
    - abbrev/uen/un/
    - abbrev/wen/wn/
    - abbrev/oen/on/
    - abbrev/uenn/unn/
  
 
 # translator:
  "translator/spelling_hints": 7
  "translator/preedit_format":  # 上屛碼直接输入国罗字
    - xform/ //  # 上屏码中的空格取消
    - xlit|;| |  # 上屏码中的;替换为空格
    # - "xlit|abcdefghijklmnopqrstuvwxyz|"
  "translator/comment_format":  # 提示碼把5改为v
    - erase/^xx$/
    - xform/\<r5/el/
    - xform/\<([jqx])u/$1v/
    - xform/([zcsrh])i([1-4])\>/$1Y$2/
    - xform/\<er/el/
    - xform/\<zh/j/
    - xform/\<z([aeiouyY])/tz$1/
    - xform/\<c([aeiouyY])/ts$1/
    - xform/\<q/ch/
    - xform/\<x/sh/
    - xform/iu([1-5])\>/iou$1/
    - xform/ui([1-5])\>/uei$1/
    - xform/ao([1-5])\>/au$1/
    - xform/un([1-5])\>/uen$1/
    - xform/v/iu/
    - xform/\<wu([1-5])\>/u$1/
    - xlit/yw/iu/
    - xform/ii/i/
    - xform/\<([lnmr]\w+)2\>/$1/
    - xform/\<([lmnr])(\w+1)\>/$1h$2/
    - xform/1\>//
    - xform/i(\w+)2\>/y$1/ 
    - xform/u(\w+)2\>/w$1/    
    - xform/(a|e|o)(i|u)2\>/$1$2r/
    - xform/(a|e|o)(|l|n|ng)2\>/$1r$2/
    - xform/i2\>/yi/
    - xform/u2\>/wu/
    - xform/\<ie3\>/yee/
    - xform/\<uo3\>/woo/
    - xform/\<i(\w*3)\>/yi$1/
    - xform/\<u(\w*3)\>/wu$1/
    - xform/i([aou]\w*)3\>/e$1/
    - xform/u([ae]\w*)3\>/o$1/
    - xform/i(n|ng)3\>/ii$1/
    - xform/ie3\>/iee/
    - xform/uo3\>/uoo/
    - xform/ai3\>/ae/
    - xform/au3\>/ao/
    - xform/(a|e|o)(|i|l|u|n|ng)3\>/$1$1$2/
    - xform/i3\>/ii/
    - xform/u3\>/uu/
    - xform/\<i4\>/yih/
    - xform/\<iu4\>/yuh/
    - xform/\<u4\>/wuh/
    - xform/\<in4\>/yinn/ 
    - xform/\<ing4\>/yinq/
    - xform/\<i(\w+4)\>/y$1/
    - xform/\<u(\w+4)\>/w$1/
    - xform/(a|e|o)4\>/$1h/
    - xform/(a|o)u4\>/$1w/
    - xform/(e|a)i4\>/$1y/
    - xform/u4\>/uh/
    - xform/i4\>/ih/
    - xform/n4\>/nn/
    - xform/l4\>/ll/
    - xform/ng4\>/nq/
    - xform/Y\>/y/
    - xform/Y2\>/yr/
    - xform/Y3\>/yy/
    - xform/Y4\>/yh/
    - xform/5\>/v/
 
 # reverse_lookup:
  # "reverse_lookup/preedit_format":  # 反查上屛碼不改
  "reverse_lookup/comment_format":  # 反查提示碼把5改为v
    - erase/^xx$/
    - xform/\<r5/el/
    - derive/^el$/l/  # 注意比"translator/comment_format"多了这一行
    - xform/\<([jqx])u/$1v/
    - xform/([zcsrh])i([1-4])\>/$1Y$2/
    - xform/\<er/el/
    - xform/\<zh/j/
    - xform/\<z([aeiouyY])/tz$1/
    - xform/\<c([aeiouyY])/ts$1/
    - xform/\<q/ch/
    - xform/\<x/sh/
    - xform/iu([1-5])\>/iou$1/
    - xform/ui([1-5])\>/uei$1/
    - xform/ao([1-5])\>/au$1/
    - xform/un([1-5])\>/uen$1/
    - xform/v/iu/
    - xform/\<wu([1-5])\>/u$1/
    - xlit/yw/iu/
    - xform/ii/i/
    - xform/\<([lnmr]\w+)2\>/$1/
    - xform/\<([lmnr])(\w+1)\>/$1h$2/
    - xform/1\>//
    - xform/i(\w+)2\>/y$1/ 
    - xform/u(\w+)2\>/w$1/    
    - xform/(a|e|o)(i|u)2\>/$1$2r/
    - xform/(a|e|o)(|l|n|ng)2\>/$1r$2/
    - xform/i2\>/yi/
    - xform/u2\>/wu/
    - xform/\<ie3\>/yee/
    - xform/\<uo3\>/woo/
    - xform/\<i(\w*3)\>/yi$1/
    - xform/\<u(\w*3)\>/wu$1/
    - xform/i([aou]\w*)3\>/e$1/
    - xform/u([ae]\w*)3\>/o$1/
    - xform/i(n|ng)3\>/ii$1/
    - xform/ie3\>/iee/
    - xform/uo3\>/uoo/
    - xform/ai3\>/ae/
    - xform/au3\>/ao/
    - xform/(a|e|o)(|i|l|u|n|ng)3\>/$1$1$2/
    - xform/i3\>/ii/
    - xform/u3\>/uu/
    - xform/\<i4\>/yih/
    - xform/\<iu4\>/yuh/
    - xform/\<u4\>/wuh/
    - xform/\<in4\>/yinn/ 
    - xform/\<ing4\>/yinq/
    - xform/\<i(\w+4)\>/y$1/
    - xform/\<u(\w+4)\>/w$1/
    - xform/(a|e|o)4\>/$1h/
    - xform/(a|o)u4\>/$1w/
    - xform/(e|a)i4\>/$1y/
    - xform/u4\>/uh/
    - xform/i4\>/ih/
    - xform/n4\>/nn/
    - xform/l4\>/ll/
    - xform/ng4\>/nq/
    - xform/Y\>/y/
    - xform/Y2\>/yr/
    - xform/Y3\>/yy/
    - xform/Y4\>/yh/
    - xform/5\>/v/
  
 
 # key_binder:
  key_binder:
    import_preset: default
    bindings:
      - { accept: Return, send: "Shift+Return", when: composing }
      - { accept: "Shift+Return", send: Return, when: composing }
      
      - { accept: minus, send: minus, when: has_menu }
      - { accept: minus, send: Page_Up, when: paging }
      # - { accept: minus, send: Page_Up, when: has_menu }
      # - { accept: equal, send: Page_Down, when: has_menu }
      
      - { accept: comma, send: comma, when: paging }
      # - { accept: comma, send: Page_Up, when: paging }
      - { accept: period, send: period, when: has_menu }
      # - { accept: period, send: Page_Down, when: has_menu }
      
      # - { accept: semicolon, send: 2, when: has_menu, }
      # - { accept: apostrophe, send: 3, when: has_menu }
